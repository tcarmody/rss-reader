/* styles.css */

/* --- CSS Variables (Theme Configuration) --- */
:root {
  --primary-color: #007bff; /* Blue */
  --primary-color-dark: #0056b3;
  --primary-color-light: #cce5ff;
  --secondary-color: #6c757d; /* Gray */
  --success-color: #28a745; /* Green */
  --success-color-dark: #1e7e34;
  --danger-color: #dc3545; /* Red */
  --danger-color-dark: #b02a37;
  --warning-color: #ffc107; /* Yellow */
  --warning-text-color: #856404;
  --info-color: #17a2b8; /* Teal */

  --neutral-0: #ffffff; /* White */
  --neutral-100: #f8f9fa; /* Lightest gray - page background */
  --neutral-200: #e9ecef; /* Light gray - card background, borders */
  --neutral-300: #dee2e6; /* Border color */
  --neutral-400: #ced4da; /* Input borders */
  --neutral-500: #adb5bd; /* Muted text, hints */
  --neutral-600: #6c757d; /* Secondary text */
  --neutral-700: #495057; /* Regular text */
  --neutral-800: #343a40; /* Headings */
  --neutral-900: #212529; /* Darkest text */

  --text-color: var(--neutral-800);
  --link-color: var(--primary-color);
  --link-hover-color: var(--primary-color-dark);

  --font-family-sans: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
  --font-family-monospace: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;

  --border-radius: 0.3rem;
  --input-border-radius: 0.25rem;
  --card-shadow: 0 2px 10px rgba(0, 0, 0, 0.075);
  --card-padding: 1.5rem;
  --main-padding: 1.5rem;
  --nav-height: 60px;
}

/* --- Basic Reset & Defaults --- */
*,
*::before,
*::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  font-size: 16px; /* Base font size */
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  scroll-behavior: smooth;
}

body {
  font-family: var(--font-family-sans);
  color: var(--text-color);
  background-color: var(--neutral-100);
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}

img, svg, video, canvas, audio, iframe, embed, object {
  display: block;
  max-width: 100%;
}

input, button, textarea, select {
  font: inherit;
  border-radius: var(--input-border-radius);
}

button {
  cursor: pointer;
  background: none;
  border: none;
  color: inherit;
}

a {
  color: var(--link-color);
  text-decoration: none;
}
a:hover {
  color: var(--link-hover-color);
  text-decoration: underline;
}

h1, h2, h3, h4, h5, h6 {
  color: var(--neutral-900);
  margin-bottom: 0.75rem;
  line-height: 1.3;
  font-weight: 600;
}
h1 { font-size: 2rem; }
h2 { font-size: 1.75rem; }
h3 { font-size: 1.5rem; }
h4 { font-size: 1.25rem; }

p {
  margin-bottom: 1rem;
}
ul, ol {
  list-style-position: inside;
  padding-left: 1.25rem;
}
li {
  margin-bottom: 0.5rem;
}

code, .code {
  font-family: var(--font-family-monospace);
  background-color: var(--neutral-200);
  padding: 0.2em 0.4em;
  border-radius: var(--input-border-radius);
  font-size: 0.9em;
  color: var(--neutral-800);
}

/* --- Accessibility --- */
.sr-only { /* Screen Reader Only */
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0,0,0,0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

/* Focus Indicators - ensure high visibility */
*:focus-visible {
  outline: 2px solid var(--primary-color);
  outline-offset: 2px;
  box-shadow: 0 0 0 4px var(--primary-color-light);
}
/* For elements that shouldn't get the default outline if they have custom focus styles */
.toggle-switch input:focus-visible + .toggle-slider {
   outline: 2px solid var(--primary-color);
   outline-offset: 1px;
}


/* --- Layout Containers --- */
.app-container {
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}

.nav {
  background-color: var(--neutral-0);
  border-bottom: 1px solid var(--neutral-300);
  padding: 0 var(--main-padding);
  height: var(--nav-height);
  display: flex;
  align-items: center;
  position: sticky;
  top: 0;
  z-index: 1000;
}

.nav-container {
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.main {
  flex-grow: 1;
  padding: var(--main-padding);
  width: 100%;
  max-width: 1200px; /* Default max width for centered content */
  margin: 0 auto;
}
.main.wide {
  max-width: 1400px; /* For pages needing more space */
}
.main.standard {
  max-width: 900px;
}

.footer {
  background-color: var(--neutral-200);
  color: var(--neutral-600);
  text-align: center;
  padding: 1rem var(--main-padding);
  border-top: 1px solid var(--neutral-300);
  font-size: 0.9em;
}

/* --- Navigation Elements --- */
.logo {
  display: flex;
  align-items: center;
  font-weight: bold;
  font-size: 1.25rem;
  color: var(--neutral-900);
}
.logo:hover {
  text-decoration: none;
  color: var(--primary-color);
}
.logo svg {
  margin-right: 0.5rem;
  color: var(--primary-color);
}
.logo-text {
  white-space: nowrap;
}

.nav-actions {
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

/* --- Card Component --- */
.card {
  background-color: var(--neutral-0);
  border: 1px solid var(--neutral-300);
  border-radius: var(--border-radius);
  padding: var(--card-padding);
  box-shadow: var(--card-shadow);
  margin-bottom: var(--main-padding);
}
.card-title {
  font-size: 1.5rem;
  margin-bottom: 1rem;
  display: flex;
  align-items: center;
}
.card-title svg {
  margin-right: 0.5rem;
}

/* --- Buttons --- */
.button {
  display: inline-flex; /* Allows icon alignment */
  align-items: center;
  justify-content: center;
  padding: 0.6em 1.2em;
  font-size: 0.95rem;
  font-weight: 500;
  border: 1px solid transparent;
  border-radius: var(--input-border-radius);
  transition: background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
}
.button:hover {
  text-decoration: none;
}
.button svg {
  margin-right: 0.4em; /* Space between icon and text */
}

/* Default button style */
.button.primary, 
.button:not([class*='outline']):not([class*='success']):not([class*='danger']) {
  background-color: var(--primary-color);
  color: var(--neutral-0);
  border-color: var(--primary-color);
}
.button.primary:hover,
.button:not([class*='outline']):not([class*='success']):not([class*='danger']):hover {
  background-color: var(--primary-color-dark);
  border-color: var(--primary-color-dark);
}

.button.outline {
  background-color: transparent;
  color: var(--primary-color);
  border-color: var(--primary-color);
}
.button.outline:hover {
  background-color: var(--primary-color-light);
  color: var(--primary-color-dark);
}
.button.outline.danger {
  color: var(--danger-color);
  border-color: var(--danger-color);
}
.button.outline.danger:hover {
  background-color: var(--danger-color);
  color: var(--neutral-0);
}


.button.success {
  background-color: var(--success-color);
  color: var(--neutral-0);
  border-color: var(--success-color);
}
.button.success:hover {
  background-color: var(--success-color-dark);
  border-color: var(--success-color-dark);
}

.button.danger {
  background-color: var(--danger-color);
  color: var(--neutral-0);
  border-color: var(--danger-color);
}
.button.danger:hover {
  background-color: var(--danger-color-dark);
  border-color: var(--danger-color-dark);
}

.button.large {
  padding: 0.8em 1.5em;
  font-size: 1.1rem;
}

.button:disabled, .button.disabled {
  opacity: 0.65;
  cursor: not-allowed;
}

.loading-spinner {
  display: inline-block;
  width: 1em;
  height: 1em;
  border: 2px solid currentColor;
  border-right-color: transparent;
  border-radius: 50%;
  animation: spinner-border .75s linear infinite;
  margin-left: 0.5em;
}
@keyframes spinner-border {
  to { transform: rotate(360deg); }
}

/* --- Forms --- */
.form-group {
  margin-bottom: 1.25rem;
}
.form-label {
  display: block;
  font-weight: 500;
  margin-bottom: 0.5rem;
  color: var(--neutral-800);
}
.form-input,
.form-input-number, /* Added for number inputs */
textarea.form-input,
select.form-input {
  display: block;
  width: 100%;
  padding: 0.6em 0.8em;
  font-size: 1rem;
  line-height: 1.5;
  color: var(--neutral-700);
  background-color: var(--neutral-0);
  background-clip: padding-box;
  border: 1px solid var(--neutral-400);
  border-radius: var(--input-border-radius);
  transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
}
.form-input:focus,
.form-input-number:focus,
textarea.form-input:focus,
select.form-input:focus {
  border-color: var(--primary-color);
  outline: 0;
  box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
}
textarea.form-input {
  min-height: 80px;
  resize: vertical;
}
.form-input-number {
  max-width: 100px; /* Default max-width for number inputs */
}
.form-hint {
  font-size: 0.875em;
  color: var(--neutral-600);
  margin-top: 0.25rem;
}
.input-group {
  display: flex;
  gap: 1rem;
}
.input-group .form-group {
  flex: 1;
}

/* --- Toggle Switch (Paywall & Settings) --- */
.paywall-container {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  position: relative; /* For tooltip positioning */
  padding: 0.3rem 0.5rem;
  border-radius: var(--input-border-radius);
  background-color: var(--neutral-100);
  border: 1px solid var(--neutral-300);
}
.paywall-label {
  font-size: 0.9em;
  color: var(--neutral-700);
  display: flex;
  align-items: center;
  gap: 0.3rem;
}
.paywall-label svg {
  width: 1em;
  height: 1em;
}

.toggle-switch {
  position: relative;
  display: inline-block;
  width: 40px;
  height: 22px;
}
.toggle-switch input { 
  opacity: 0;
  width: 0;
  height: 0;
}
.toggle-slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: var(--neutral-400);
  transition: .4s;
  border-radius: 22px;
}
.toggle-slider:before {
  position: absolute;
  content: "";
  height: 16px;
  width: 16px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  transition: .4s;
  border-radius: 50%;
}
.toggle-switch input:checked + .toggle-slider {
  background-color: var(--success-color);
}
.danger-toggle .toggle-switch input:checked + .toggle-slider {
  background-color: var(--danger-color);
}
.toggle-switch input:focus + .toggle-slider {
  box-shadow: 0 0 0 2px var(--primary-color-light), 0 0 0 4px var(--primary-color);
  outline: none;
}
.toggle-switch input:checked + .toggle-slider:before {
  transform: translateX(18px);
}
.warning-tooltip {
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%) translateY(-5px);
  background-color: var(--warning-color);
  color: var(--warning-text-color);
  padding: 0.5em 0.8em;
  border-radius: var(--input-border-radius);
  font-size: 0.8em;
  white-space: nowrap;
  z-index: 10;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  display: none; /* Hidden by default */
}
.paywall-container:hover .warning-tooltip,
.paywall-container input:focus + .toggle-slider + .warning-tooltip { /* Show on hover or focus of parent */
  display: block;
}


/* --- Welcome Page Specifics --- */
.settings-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: var(--main-padding);
  margin-bottom: var(--main-padding);
}
.setting-card {
  background-color: var(--neutral-0);
  border: 1px solid var(--neutral-300);
  border-radius: var(--border-radius);
  padding: var(--card-padding);
}
.setting-header {
  display: flex;
  align-items: center;
  margin-bottom: 0.75rem;
}
.setting-icon {
  margin-right: 0.75rem;
  color: var(--primary-color);
  width: 24px; height: 24px;
}
.setting-title {
  font-size: 1.1rem;
  font-weight: 600;
  margin-bottom: 0;
}
.setting-description {
  font-size: 0.9em;
  color: var(--neutral-600);
  margin-bottom: 1rem;
}
.toggle-container {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.5rem 0;
}
.toggle-label {
  font-weight: 500;
}
.warning-text {
  font-size: 0.8em;
  color: var(--danger-color);
  margin-top: 0.5rem;
}

.clustering-settings-container {
  margin-top: 2rem;
  border: 1px solid var(--neutral-300);
  border-radius: var(--border-radius);
  padding: var(--card-padding);
}
.clustering-settings-title {
  display: flex;
  align-items: center;
  font-size: 1.25rem;
  font-weight: 600;
  margin-bottom: 1.5rem;
}
.clustering-settings-title svg {
  margin-right: 0.75rem;
  color: var(--primary-color);
}
.setting-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.75rem 0;
  border-bottom: 1px solid var(--neutral-200);
}
.setting-row:last-child {
  border-bottom: none;
}
.setting-row > div:first-child { /* Text content part */
  margin-right: 1rem;
}
.setting-name {
  font-weight: 500;
}
.setting-description {
  font-size: 0.85em;
  color: var(--neutral-600);
}
.buttons-container {
  margin-top: 1.5rem;
  display: flex;
  gap: 1rem;
  justify-content: flex-start;
}

/* Tabs (Welcome Page) */
.tabs {
  display: flex;
  border-bottom: 2px solid var(--neutral-300);
  margin-bottom: 1.5rem;
}
.tab {
  padding: 0.75rem 1.25rem;
  cursor: pointer;
  background-color: transparent;
  border: none;
  border-bottom: 2px solid transparent;
  margin-bottom: -2px; /* Overlap with container border */
  font-size: 1rem;
  font-weight: 500;
  color: var(--neutral-600);
  transition: color 0.2s, border-color 0.2s;
}
.tab:hover {
  color: var(--primary-color);
}
.tab.active, .tab:focus { /* Focus also indicates active for accessibility */
  color: var(--primary-color);
  border-bottom-color: var(--primary-color);
  font-weight: 600;
}
.tab-content {
  padding: 0; /* Content inside often has its own padding */
}
.tab-content:not(.active) {
  display: none;
}


/* --- Feed Summary Page / Multiple & Single Summary Pages --- */
.page-header {
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 1px solid var(--neutral-300);
  display: flex;
  justify-content: space-between;
  align-items: baseline;
}
.page-title {
  margin-bottom: 0;
}
.timestamp, .time-range-info {
  font-size: 0.9em;
  color: var(--neutral-600);
}
.time-range-info {
  margin-bottom: 1rem;
  padding: 0.5rem 1rem;
  background-color: var(--primary-color-light);
  border: 1px solid var(--primary-color);
  color: var(--primary-color-dark);
  border-radius: var(--input-border-radius);
}

.summary-url-container {
  margin-bottom: 1.5rem;
  padding: 1rem;
  background-color: var(--neutral-100); /* Slightly different background */
  border: 1px solid var(--neutral-200);
  border-radius: var(--input-border-radius);
}
.summary-url-label {
  font-weight: 600;
  margin-right: 0.5rem;
}
.summary-url-link {
  word-break: break-all;
}
.url-list .url-item {
  padding: 0.25rem 0;
  font-size: 0.9em;
  color: var(--neutral-700);
  border-bottom: 1px dashed var(--neutral-200);
}
.url-list .url-item:last-child {
  border-bottom: none;
}


.cluster {
  background-color: var(--neutral-0);
  border: 1px solid var(--neutral-300);
  border-radius: var(--border-radius);
  margin-bottom: 2rem;
  box-shadow: var(--card-shadow);
}
.cluster-header {
  padding: 1rem 1.5rem;
  border-bottom: 1px solid var(--neutral-200);
  background-color: var(--neutral-100); /* Header slightly different */
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.cluster-title {
  font-size: 1.3rem;
  margin-bottom: 0;
}
.cluster-info {
  font-size: 0.9em;
  color: var(--neutral-600);
  background-color: var(--neutral-200);
  padding: 0.25rem 0.6rem;
  border-radius: 1rem;
}
.article-summary {
  padding: 1.5rem;
  font-size: 1rem;
  line-height: 1.7;
}
.article-summary p:last-child {
  margin-bottom: 0;
}

.articles-container {
  padding: 0 1.5rem 1.5rem;
}
.articles-container ul {
  list-style: none;
  padding-left: 0;
}
.article {
  padding: 0.75rem 0;
  border-bottom: 1px solid var(--neutral-200);
}
.article:last-child {
  border-bottom: none;
  padding-bottom: 0;
}
.article-title {
  font-size: 1.05rem;
  font-weight: 500;
  margin-bottom: 0.25rem;
}
.article-title a {
  color: var(--neutral-800);
}
.article-title a:hover {
  color: var(--primary-color);
}
.article-source {
  font-size: 0.85em;
  color: var(--neutral-600);
  margin-left: 0.5rem;
}
.article-meta {
  font-size: 0.85em;
  color: var(--neutral-500);
}
.summary-actions {
  padding: 1rem 1.5rem;
  border-top: 1px solid var(--neutral-200);
  background-color: var(--neutral-100);
}

.cluster-topics {
  margin-top: 1rem;
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}
.topic-tag, .entity-tag {
  font-size: 0.8em;
  padding: 0.25em 0.6em;
  border-radius: var(--input-border-radius);
  background-color: var(--neutral-200);
  color: var(--neutral-700);
  border: 1px solid var(--neutral-300);
}
.entity-tag {
  background-color: var(--primary-color-light);
  border-color: var(--primary-color);
  color: var(--primary-color-dark);
}

/* --- Settings Modal (Feed Summary Page) --- */
.settings-container { /* Relative positioning for the menu */
  position: relative;
}
.settings-button {
  padding: 0.4rem 0.6rem; /* Adjust padding for icon button */
  border-radius: var(--input-border-radius);
  line-height: 1; /* For better icon centering */
}
.settings-button:hover {
  background-color: var(--neutral-200);
}
.settings-button svg {
  width: 20px;
  height: 20px;
  margin-right: 0; /* No text */
}

.settings-menu {
  position: absolute;
  top: calc(100% + 5px); /* Below the button */
  right: 0;
  width: 350px; /* Adjust as needed */
  max-width: 90vw;
  background-color: var(--neutral-0);
  border: 1px solid var(--neutral-300);
  border-radius: var(--border-radius);
  box-shadow: 0 5px 15px rgba(0,0,0,0.15);
  z-index: 1010; /* Above nav */
  padding: 1rem;
}
.settings-menu[hidden] {
  display: none !important; /* Ensure it's hidden for ARIA */
}
.settings-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  padding-bottom: 0.75rem;
  border-bottom: 1px solid var(--neutral-200);
}
.settings-title { /* For modal */
  font-size: 1.1rem;
  margin-bottom: 0;
}
.settings-close {
  background: none;
  border: none;
  font-size: 1.5rem;
  line-height: 1;
  padding: 0.25rem;
  color: var(--neutral-500);
}
.settings-close:hover {
  color: var(--neutral-800);
}
.settings-menu .setting-row {
  padding: 0.6rem 0; /* Slightly less padding in modal */
}
.model-info {
  margin-top: 1rem;
  padding-top: 1rem;
  border-top: 1px solid var(--neutral-200);
  font-size: 0.9em;
  color: var(--neutral-600);
}
.model-info h4 {
  font-size: 1em;
  color: var(--neutral-700);
  margin-bottom: 0.3rem;
}
.model-info div {
  margin-bottom: 0.2rem;
}

/* --- Banners --- */
.info-banner, .warning-banner, .error-banner {
  padding: 1rem 1.5rem;
  margin-bottom: 1.5rem;
  border: 1px solid transparent;
  border-radius: var(--input-border-radius);
  font-size: 0.95rem;
}
.info-banner {
  color: var(--info-color); /* Darker teal for text */
  background-color: #d1ecf1;
  border-color: #bee5eb;
}
.warning-banner {
  color: var(--warning-text-color);
  background-color: #fff3cd;
  border-color: #ffeeba;
}
.error-banner, .error-message { /* For error.html */
  color: #721c24;
  background-color: #f8d7da;
  border-color: #f5c6cb;
}
.error-message {
  margin-top: 1rem;
  margin-bottom: 1.5rem;
}
.error-actions {
  margin-top: 1rem;
}

/* --- Utility Classes --- */
.mb-4 { margin-bottom: 1.5rem !important; } /* Example utility */
.mt-6 { margin-top: 2rem !important; } /* Example utility */
.strong { font-weight: 600; }
.text-center { text-align: center; }

/* --- Responsive Adjustments --- */
@media (max-width: 768px) {
  html { font-size: 15px; }
  :root {
    --card-padding: 1rem;
    --main-padding: 1rem;
  }
  .nav {
    padding: 0 var(--main-padding);
  }
  .nav-actions {
    gap: 0.5rem; /* Reduce gap on smaller screens */
  }
  .nav-actions .button { /* Smaller buttons in nav */
    padding: 0.4em 0.8em;
    font-size: 0.85rem;
  }
  .logo svg { width: 20px; height: 20px;}
  .logo-text { font-size: 1.1rem;}

  .page-header {
    flex-direction: column;
    align-items: flex-start;
  }
  .timestamp { margin-top: 0.5rem; }

  .input-group {
    flex-direction: column;
    gap: 0; /* Form groups already have margin */
  }
  .settings-grid {
    grid-template-columns: 1fr; /* Stack cards */
  }
  .tabs {
    font-size: 0.9rem; /* Smaller tabs */
  }
  .tab {
    padding: 0.6rem 1rem;
  }
  .cluster-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.5rem;
  }
  .settings-menu { /* Modal might need to be wider on small screens */
    width: 90vw;
    left: 50%;
    transform: translateX(-50%);
  }
}

@media (max-width: 480px) {
  html { font-size: 14px; }
  .nav-actions .button.outline,
  .nav-actions .paywall-container { /* Hide text on very small screens for some buttons */
    font-size: 0; /* Hide text by making font size 0 */
  }
  .nav-actions .button.outline svg,
  .nav-actions .paywall-container svg {
    margin-right: 0; /* Remove margin if text is hidden */
  }
  /* Removed empty selector that was previously here */
  .button.large {
    font-size: 1rem;
    padding: 0.7em 1.2em;
  }
  .paywall-container .warning-tooltip {
    font-size: 0.75em;
    max-width: 200px;
    white-space: normal; /* Allow wrapping */
    transform: translateX(-70%) translateY(-5px); /* Adjust positioning */
  }
}